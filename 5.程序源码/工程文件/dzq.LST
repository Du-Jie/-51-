C51 COMPILER V9.56.0.0   DZQ                                                               04/15/2020 10:04:46 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE DZQ
OBJECT MODULE PLACED IN dzq.OBJ
COMPILER INVOKED BY: D:\MKD\C51\BIN\C51.EXE dzq.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND

line level    source

   1          
   2          
   3          #include <REGX52.H>                     //调系统头文件
   4          #include <intrins.h>
   5          #include <lcd.h>
   6          
   7          #define uchar unsigned char     //uchar代替 unsigned char
   8          #define uint unsigned int       //uint代替 unsigned char
   9                  
  10          #define Key1    P2_0    //定义按键1(播放 "挥着翅膀的女孩")
  11          #define Key2    P2_1    //定义按键2(播放 "同一首歌")
  12          //#define Key3  P2_2    //定义按键3(播放 "两只蝴蝶")
  13          #define Key3    P3_2    //定义按键3(播放 "两只蝴蝶")
  14          
  15          #define SMG             P0              //定义屏幕显示端
  16          #define Speak   P2_4    //定义蜂鸣器接口
  17          
  18          uchar sth,stl;                  //定义全局变量 sth stl
  19          uint i,j;                               //定义循环变量i j
  20          
  21          
  22          unsigned char table[] = {"yinfu:            "};
  23          unsigned char table1[] ={"music:            "};
  24          
  25          
  26          //uchar code table[]={0X18,0XDE,0X34,0X94,0XD2,0X91,0X11,0XDC,0X10,0x90,
  27          //                                      0X50,0X13,0X39,0X16,0X31,0X71};//定义屏幕显示 0-9,A-F
  28          
  29          
  30          uchar code Music_hzcb[]={//《挥着翅膀的女孩》系统自带歌曲音符
  31                  0x17,0x02, 0x17,0x03, 0x18,0x03, 0x19,0x02, 0x15,0x03,
  32              0x16,0x03, 0x17,0x03, 0x17,0x03, 0x17,0x03, 0x18,0x03,
  33                  0x19,0x02, 0x16,0x03, 0x17,0x03, 0x18,0x02, 0x18,0x03,
  34              0x17,0x03, 0x15,0x02, 0x18,0x03, 0x17,0x03, 0x18,0x02,
  35              0x10,0x03, 0x15,0x03, 0x16,0x02, 0x15,0x03, 0x16,0x03,
  36              0x17,0x02, 0x17,0x03, 0x18,0x03, 0x19,0x02, 0x1A,0x03,
  37              0x1B,0x03, 0x1F,0x03, 0x1F,0x03, 0x17,0x03, 0x18,0x03,
  38              0x19,0x02, 0x16,0x03, 0x17,0x03, 0x18,0x03, 0x17,0x03,
  39              0x18,0x03, 0x1F,0x03, 0x1F,0x02, 0x16,0x03, 0x17,0x03,
  40              0x18,0x03, 0x17,0x03, 0x18,0x03, 0x20,0x03, 0x20,0x02,
  41              0x1F,0x03, 0x1B,0x03, 0x1F,0x66, 0x20,0x03, 0x21,0x03,
  42              0x20,0x03, 0x1F,0x03, 0x1B,0x03, 0x1F,0x66, 0x1F,0x03,
  43              0x1B,0x03, 0x19,0x03, 0x19,0x03, 0x15,0x03, 0x1A,0x66,
  44              0x1A,0x03, 0x19,0x03, 0x15,0x03, 0x15,0x03, 0x17,0x03,
  45              0x16,0x66, 0x17,0x04, 0x18,0x04, 0x18,0x03, 0x19,0x03,
  46              0x1F,0x03, 0x1B,0x03, 0x1F,0x66, 0x20,0x03, 0x21,0x03,
  47              0x20,0x03, 0x1F,0x03, 0x1B,0x03, 0x1F,0x66, 0x1F,0x03,
  48              0x1B,0x03, 0x19,0x03, 0x19,0x03, 0x15,0x03, 0x1A,0x66,
  49              0x1A,0x03, 0x19,0x03, 0x19,0x03, 0x1F,0x03, 0x1B,0x03,
  50              0x1F,0x00, 0x1A,0x03, 0x1A,0x03, 0x1A,0x03, 0x1B,0x03,
  51              0x1B,0x03, 0x1A,0x03, 0x19,0x03, 0x19,0x02, 0x17,0x03,
  52              0x15,0x17, 0x15,0x03, 0x16,0x03, 0x17,0x03, 0x18,0x03,
  53              0x17,0x04, 0x18,0x0E, 0x18,0x03, 0x17,0x04, 0x18,0x0E,
  54              0x18,0x66, 0x17,0x03, 0x18,0x03, 0x17,0x03, 0x18,0x03,
  55              0x20,0x03, 0x20,0x02, 0x1F,0x03, 0x1B,0x03, 0x1F,0x66,
C51 COMPILER V9.56.0.0   DZQ                                                               04/15/2020 10:04:46 PAGE 2   

  56              0x20,0x03, 0x21,0x03, 0x20,0x03, 0x1F,0x03, 0x1B,0x03,
  57              0x1F,0x66, 0x1F,0x04, 0x1B,0x0E, 0x1B,0x03, 0x19,0x03,
  58              0x19,0x03, 0x15,0x03, 0x1A,0x66, 0x1A,0x03, 0x19,0x03,
  59              0x15,0x03, 0x15,0x03, 0x17,0x03, 0x16,0x66, 0x17,0x04,
  60              0x18,0x04, 0x18,0x03, 0x19,0x03, 0x1F,0x03, 0x1B,0x03,
  61              0x1F,0x66, 0x20,0x03, 0x21,0x03, 0x20,0x03, 0x1F,0x03,
  62              0x1B,0x03, 0x1F,0x66, 0x1F,0x03, 0x1B,0x03, 0x19,0x03,
  63              0x19,0x03, 0x15,0x03, 0x1A,0x66, 0x1A,0x03, 0x19,0x03,
  64              0x19,0x03, 0x1F,0x03, 0x1B,0x03, 0x1F,0x00, 0x18,0x02,
  65              0x18,0x03, 0x1A,0x03, 0x19,0x0D, 0x15,0x03, 0x15,0x02,
  66              0x18,0x66, 0x16,0x02, 0x17,0x02, 0x15,0x00, 0xff,0xff}; 
  67               
  68          uchar code Music_tyshg[]={//《同一首歌》 系统自带歌曲音符
  69                  0x0F,0x01, 0x15,0x02, 0x16,0x02, 0x17,0x66, 0x18,0x03,
  70              0x17,0x02, 0x15,0x02, 0x16,0x01, 0x15,0x02, 0x10,0x02,
  71              0x15,0x00, 0x0F,0x01, 0x15,0x02, 0x16,0x02, 0x17,0x02,
  72              0x17,0x03, 0x18,0x03, 0x19,0x02, 0x15,0x02, 0x18,0x66,
  73              0x17,0x03, 0x19,0x02, 0x16,0x03, 0x17,0x03, 0x16,0x00,
  74              0x17,0x01, 0x19,0x02, 0x1B,0x02, 0x1B,0x70, 0x1A,0x03,
  75              0x1A,0x01, 0x19,0x02, 0x19,0x03, 0x1A,0x03, 0x1B,0x02,
  76              0x1A,0x0D, 0x19,0x03, 0x17,0x00, 0x18,0x66, 0x18,0x03,
  77              0x19,0x02, 0x1A,0x02, 0x19,0x0C, 0x18,0x0D, 0x17,0x03,
  78              0x16,0x01, 0x11,0x02, 0x11,0x03, 0x10,0x03, 0x0F,0x0C,
  79              0x10,0x02, 0x15,0x00, 0x1F,0x01, 0x1A,0x01, 0x18,0x66,
  80              0x19,0x03, 0x1A,0x01, 0x1B,0x02, 0x1B,0x03, 0x1B,0x03,
  81              0x1B,0x0C, 0x1A,0x0D, 0x19,0x03, 0x17,0x00, 0x1F,0x01,
  82              0x1A,0x01, 0x18,0x66, 0x19,0x03, 0x1A,0x01, 0x10,0x02,
  83              0x10,0x03, 0x10,0x03, 0x1A,0x0C, 0x18,0x0D, 0x17,0x03,
  84              0x16,0x00, 0x0F,0x01, 0x15,0x02, 0x16,0x02, 0x17,0x70,
  85              0x18,0x03, 0x17,0x02, 0x15,0x03, 0x15,0x03, 0x16,0x66,
  86              0x16,0x03, 0x16,0x02, 0x16,0x03, 0x15,0x03, 0x10,0x02,
  87              0x10,0x01, 0x11,0x01, 0x11,0x66, 0x10,0x03, 0x0F,0x0C,
  88              0x1A,0x02, 0x19,0x02, 0x16,0x03, 0x16,0x03, 0x18,0x66,
  89              0x18,0x03, 0x18,0x02, 0x17,0x03, 0x16,0x03, 0x19,0x00,
  90              0xff,0xff };
  91                                          
  92          uchar code Music_lzhhd[] ={//《两只蝴蝶》系统自带歌曲音符
  93                  0x17,0x03, 0x16,0x03, 0x17,0x01, 0x16,0x03, 0x17,0x03,
  94              0x16,0x03, 0x15,0x01, 0x10,0x03, 0x15,0x03, 0x16,0x02,
  95              0x16,0x0D, 0x17,0x03, 0x16,0x03, 0x15,0x03, 0x10,0x03,
  96              0x10,0x0E, 0x15,0x04, 0x0F,0x01, 0x17,0x03, 0x16,0x03,
  97              0x17,0x01, 0x16,0x03, 0x17,0x03, 0x16,0x03, 0x15,0x01,
  98                  0x10,0x03, 0x15,0x03, 0x16,0x02, 0x16,0x0D, 0x17,0x03,
  99                  0x16,0x03, 0x15,0x03, 0x10,0x03, 0x15,0x03, 0x16,0x01,
 100                  0x17,0x03, 0x16,0x03, 0x17,0x01, 0x16,0x03, 0x17,0x03,
 101                  0x16,0x03, 0x15,0x01, 0x10,0x03, 0x15,0x03, 0x16,0x02,
 102                  0x16,0x0D, 0x17,0x03, 0x16,0x03, 0x15,0x03, 0x10,0x03,
 103                  0x10,0x0E, 0x15,0x04, 0x0F,0x01, 0x17,0x03, 0x19,0x03,
 104                  0x19,0x01, 0x19,0x03, 0x1A,0x03, 0x19,0x03, 0x17,0x01,  
 105                  0x16,0x03, 0x16,0x03, 0x16,0x02, 0x16,0x0D, 0x17,0x03,
 106                  0x16,0x03, 0x15,0x03, 0x10,0x03, 0x10,0x0D, 0x15,0x00,
 107                  0x19,0x03, 0x19,0x03, 0x1A,0x03, 0x1F,0x03, 0x1B,0x03,
 108                  0x1B,0x03, 0x1A,0x03, 0x17,0x0D, 0x16,0x03, 0x16,0x03,
 109                  0x16,0x0D, 0x17,0x01, 0x17,0x03, 0x17,0x03, 0x19,0x03,
 110                  0x1A,0x02, 0x1A,0x02, 0x10,0x03, 0x17,0x0D, 0x16,0x03,
 111                  0x16,0x01, 0x17,0x03, 0x19,0x03, 0x19,0x03, 0x17,0x03,
 112                  0x19,0x02, 0x1F,0x02, 0x1B,0x03, 0x1A,0x03, 0x1A,0x0E,
 113                  0x1B,0x04, 0x17,0x02, 0x1A,0x03, 0x1A,0x03, 0x1A,0x0E,
 114                  0x1B,0x04, 0x1A,0x03, 0x19,0x03, 0x17,0x03, 0x16,0x03,
 115                  0x17,0x0D, 0x16,0x03, 0x17,0x03, 0x19,0x01, 0x19,0x03,
 116                  0x19,0x03, 0x1A,0x03, 0x1F,0x03, 0x1B,0x03, 0x1B,0x03,
 117                  0x1A,0x03, 0x17,0x0D, 0x16,0x03, 0x16,0x03, 0x16,0x03,
C51 COMPILER V9.56.0.0   DZQ                                                               04/15/2020 10:04:46 PAGE 3   

 118                  0x17,0x01, 0x17,0x03, 0x17,0x03, 0x19,0x03, 0x1A,0x02,
 119                  0x1A,0x02, 0x10,0x03, 0x17,0x0D, 0x16,0x03, 0x16,0x01,
 120                  0x17,0x03, 0x19,0x03, 0x19,0x03, 0x17,0x03, 0x19,0x03,
 121                  0x1F,0x02, 0x1B,0x03, 0x1A,0x03, 0x1A,0x0E, 0x1B,0x04,
 122                  0x17,0x02, 0x1A,0x03, 0x1A,0x03, 0x1A,0x0E, 0x1B,0x04,
 123                  0x17,0x16, 0x1A,0x03, 0x1A,0x03, 0x1A,0x0E, 0x1B,0x04,
 124                  0x1A,0x03, 0x19,0x03, 0x17,0x03, 0x16,0x03, 0x0F,0x02,
 125                  0x10,0x03, 0x15,0x00, 0xff,0xff };
 126            
 127          unsigned char code music_tab[] ={      // 八月桂花
 128          0x18, 0x30, 0x1C , 0x10, //格式为: 频率常数, 节拍常数, 频率常数, 节拍常数,    
 129          0x20, 0x40, 0x1C , 0x10,   
 130          0x18, 0x10, 0x20 , 0x10,   
 131          0x1C, 0x10, 0x18 , 0x40,   
 132          0x1C, 0x20, 0x20 , 0x20,   
 133          0x1C, 0x20, 0x18 , 0x20,   
 134          0x20, 0x80, 0xFF , 0x20,   
 135          0x30, 0x1C, 0x10 , 0x18,   
 136          0x20, 0x15, 0x20 , 0x1C,   
 137          0x20, 0x20, 0x20 , 0x26,   
 138          0x40, 0x20, 0x20 , 0x2B,   
 139          0x20, 0x26, 0x20 , 0x20,   
 140          0x20, 0x30, 0x80 , 0xFF,   
 141          0x20, 0x20, 0x1C , 0x10,   
 142          0x18, 0x10, 0x20 , 0x20,   
 143          0x26, 0x20, 0x2B , 0x20,   
 144          0x30, 0x20, 0x2B , 0x40,   
 145          0x20, 0x20, 0x1C , 0x10,   
 146          0x18, 0x10, 0x20 , 0x20,   
 147          0x26, 0x20, 0x2B , 0x20,   
 148          0x30, 0x20, 0x2B , 0x40,   
 149          0x20, 0x30, 0x1C , 0x10,   
 150          0x18, 0x20, 0x15 , 0x20,   
 151          0x1C, 0x20, 0x20 , 0x20,   
 152          0x26, 0x40, 0x20 , 0x20,   
 153          0x2B, 0x20, 0x26 , 0x20,   
 154          0x20, 0x20, 0x30 , 0x80,   
 155          0x20, 0x30, 0x1C , 0x10,   
 156          0x20, 0x10, 0x1C , 0x10,   
 157          0x20, 0x20, 0x26 , 0x20,   
 158          0x2B, 0x20, 0x30 , 0x20,   
 159          0x2B, 0x40, 0x20 , 0x15,   
 160          0x1F, 0x05, 0x20 , 0x10,   
 161          0x1C, 0x10, 0x20 , 0x20,   
 162          0x26, 0x20, 0x2B , 0x20,   
 163          0x30, 0x20, 0x2B , 0x40,   
 164          0x20, 0x30, 0x1C , 0x10,   
 165          0x18, 0x20, 0x15 , 0x20,   
 166          0x1C, 0x20, 0x20 , 0x20,   
 167          0x26, 0x40, 0x20 , 0x20,   
 168          0x2B, 0x20, 0x26 , 0x20,   
 169          0x20, 0x20, 0x30 , 0x30,   
 170          0x20, 0x30, 0x1C , 0x10,   
 171          0x18, 0x40, 0x1C , 0x20,   
 172          0x20, 0x20, 0x26 , 0x40,   
 173          0x13, 0x60, 0x18 , 0x20,   
 174          0x15, 0x40, 0x13 , 0x40,   
 175          0x18, 0x80, 0x00   
 176          }; 
 177          
 178          
 179          uchar code Music_Code[]={               //八个音符      do re mi fa so la si 高音do 
C51 COMPILER V9.56.0.0   DZQ                                                               04/15/2020 10:04:46 PAGE 4   

 180                  0xf8,0x8b,0xf9,0x5b,0xfa,0x14,0xfa,0x66,
 181                  0xfb,0x03,0xfb,0x8f,0xfc,0x0b,0xfd,0xee};                                                                         
 182          uchar const yinfu1[3][14]={             //低中高三种音符
 183                  0xf8,0x8b,0xf9,0x5b,0xfa,0x14,0xfa,0x66,0xfb,0x03,0xfb,0x8f,0xfc,0x0b,
 184                  0xfc,0x43,0xfc,0xab,0xfd,0x08,0xfd,0x33,0xfd,0x81,0xfd,0xc7,0xfe,0x05,
 185                  0xfb,0x21,0xfe,0x55,0xfe,0x84,0xfe,0x99,0xfe,0xc0,0xfe,0xe3,0xff,0x02};
 186          uchar const length[]={1,2,4,8,16,32,64};        //几分音符查表(节拍)
 187          
 188          
 189          void delay_ms(uint time)        //毫秒延时函数
 190          {
 191   1              uint z;
 192   1              uchar x,y;
 193   1              for(z=0;z<time;z++)
 194   1              for(x=5;x>0;x--)
 195   1              for(y=97;y>0;y--); 
 196   1      }
 197          
 198          void Time0_Init()                       //定时器T0初始化函数            
 199          {
 200   1              TMOD=0x01;      //工作方式1
 201   1              TH0=sth;    //定时器高八位赋初值     
 202   1              TL0=stl;        //定时器低八位赋初值
 203   1              ET0=1;          //使能T0中断
 204   1              EA=1;           //打开全局中断
 205   1              TR0=0;          //关闭定时器T0
 206   1      } 
 207          
 208          void main()     //主函数入口
 209          {
 210   1          LcdInit();//液晶初始化
 211   1              Time0_Init();   //定时器T0初始化
 212   1              Speak=1;                //蜂鸣器端口置1 (让蜂鸣器处于与电源5V断电状态)
 213   1              while(1)        //无限循环      
 214   1              {
 215   2      //    LcdWriteCom(0x80+9);
 216   2      //      LcdWriteData(0X30+1);
 217   2      //      LcdWriteData(0X30+2);
 218   2      //      LcdWriteData(0X30+3);
 219   2              
 220   2              
 221   2                      switch(P1)              //switch语句判断检测 P1按键状态
 222   2                      {  
 223   3                              case 0xfe:      //P1=0xfe    "do"按键按下                       
 224   3                                                      delay_ms(10);   //延时去抖      
 225   3                                                      if(P1==0xfe)    //再判断"do"按键是否按下
 226   3                                                      {       
 227   4                                  LcdWriteCom(0x80+9);
 228   4                                  LcdWriteData(0X30+1);        //屏幕显示"1"  
 229   4                                                              i=0;                    //i置0
 230   4                                          TR0=0;              //关闭定时器T0
 231   4                                                              sth=Music_Code[2*i];    //定时器高八位赋值 "do"
 232   4                                                          stl=Music_Code[2*i+1];      //定时器低八位赋值 "do"
 233   4                                                              TR0=1;                  //启动定时器T0
 234   4                                                              for(j=0;j<=1000;j++)    //软件延时,在一定时间里检测
 235   4                                                              {                                                                                       
 236   5                                                                      delay_ms(10);           //延时一下
 237   5                                                                      if(P1==0xfe) continue;  //"do"按键按下,跳出(继续发音)
 238   5                                                                      else break;                     //松开了,则返回
 239   5                                                              }
 240   4                                      //关闭屏幕显示
 241   4                                  LcdInit();//液晶初始化
C51 COMPILER V9.56.0.0   DZQ                                                               04/15/2020 10:04:46 PAGE 5   

 242   4                                                              Speak=1;        //蜂鸣器端口置1 (让蜂鸣器处于与电源5V断电状态)
 243   4                                                              TR0=0;          //关闭定时器T0
 244   4                                                              for(;;) 
 245   4                                                              {
 246   5                                                                      while(P1==0xfe);        //等待按键松开                                                                                                  
 247   5                                                                      delay_ms(10);           //延时去抖
 248   5                                                                      if(P1==0xfe) continue;  
 249   5                                                                      else break;                     //确定松开,退出
 250   5                                                              }
 251   4                                                              TR0=0;          //关闭定时器T0
 252   4                                                      }
 253   3                                                      break;                  //返回
 254   3                              case 0xfd:      //P1=0xfd       "re"按键按下            
 255   3                                                      delay_ms(10);   //延时去抖
 256   3                                                      if(P1==0xfd)    //再判断"re"按键是否按下
 257   3                                              {
 258   4                                  //屏幕显示"2"
 259   4                                  LcdWriteCom(0x80+9);
 260   4                                  LcdWriteData(0X30+2);
 261   4                                                              i=1;                    //i置1
 262   4                                                              TR0=0;                  //关闭定时器T0
 263   4                                                              sth=Music_Code[2*i];    //定时器高八位赋值 "re"
 264   4                                                              stl=Music_Code[2*i+1];  //定时器低八位赋值 "re"
 265   4                                                              TR0=1;                  //启动定时器T0          
 266   4                                                              for(j=0;j<=1000;j++)    //软件延时,在一定时间里检测
 267   4                                                              {                                                                                                       
 268   5                                                                      delay_ms(10);   //延时一下      
 269   5                                                                      if(P1==0xfd) continue;  //"re"按键按下,跳出(继续发音)   
 270   5                                                                      else break;             //松开了,则返回
 271   5                                                              }
 272   4                                      //关闭屏幕显示
 273   4                                  LcdInit();//液晶初始化
 274   4                                                              Speak=1;        //蜂鸣器端口置1 (让蜂鸣器处于与电源5V断电状态)
 275   4                                                              TR0=0;          //关闭定时器T0
 276   4                                                              for(;;)
 277   4                                                              {
 278   5                                                                      while(P1==0xfd);        //等待按键松开
 279   5                                                                      delay_ms(10);           //延时去抖
 280   5                                                                      if(P1==0xfd) continue;  
 281   5                                                                      else break;                     //确定松开,退出
 282   5                                                              }
 283   4                                                      }
 284   3                                                      TR0=0;                  //关闭定时器T0
 285   3                                                      break;                  //返回
 286   3                              case 0xef:      //P1=0xef       "mi"按键按下 
 287   3                                                      delay_ms(10);   //延时去抖                      
 288   3                                                      if(P1==0xef)    //再判断"mi"按键是否按下
 289   3                                                      {
 290   4                                  //屏幕显示"3"
 291   4                                  LcdWriteCom(0x80+9);
 292   4                                  LcdWriteData(0X30+3);
 293   4                                                              i=2;                    //i置2  
 294   4                                                              TR0=0;                  //关闭定时器T0  
 295   4                                                              sth=Music_Code[2*i];    //定时器高八位赋值 "mi" 
 296   4                                                              stl=Music_Code[2*i+1];  //定时器低八位赋值 "mi"
 297   4                                                              TR0=1;                  //启动定时器T0  
 298   4                                                              for(j=0;j<=1000;j++)    //软件延时,在一定时间里检测
 299   4                                                              {                                                                                       
 300   5                                                                      delay_ms(10);   //延时一下
 301   5                                                                      if(P1==0xef) continue;  //"mi"按键按下,跳出(继续发音)
 302   5                                                                      else break;             //松开了,则返回
 303   5                                                              }
C51 COMPILER V9.56.0.0   DZQ                                                               04/15/2020 10:04:46 PAGE 6   

 304   4                                      //关闭屏幕显示
 305   4                                  LcdInit();//液晶初始化
 306   4                                                              Speak=1;        //蜂鸣器端口置1 (让蜂鸣器处于与电源5V断电状态)
 307   4                                                              TR0=0;          //关闭定时器T0
 308   4                                                              for(;;)
 309   4                                                              {
 310   5                                                                      while(P1==0xef);        //等待按键松开  
 311   5                                                                      delay_ms(10);           //延时去抖
 312   5                                                                      if(P1==0xef) continue;
 313   5                                                                      else break;                     //确定松开,退出
 314   5                                                              }
 315   4                                                      }
 316   3                                                      TR0=0;                  //关闭定时器T0
 317   3                                                      break;                  //返回          
 318   3                              default:        break;                  //没有P1没有按键按下,返回
 319   3                  }
 320   2              
 321   2              
 322   2              
 323   2                      switch(P3)              //switch语句判断检测 P3按键状态
 324   2                      {
 325   3                              case 0xfe:      //P3=0xfe       "fa"按键按下 
 326   3                                                      delay_ms(10);   //延时去抖      
 327   3                                                      if(P3==0xfe)    //再判断"fa"按键是否按下
 328   3                                                      {
 329   4                                  //屏幕显示"4"
 330   4                                  LcdWriteCom(0x80+9);
 331   4                                  LcdWriteData(0X30+4);
 332   4                                                              i=3;                    //i置3
 333   4                                                              TR0=0;                  //关闭定时器T0  
 334   4                                                              sth=Music_Code[2*i];    //定时器高八位赋值 "fa" 
 335   4                                                              stl=Music_Code[2*i+1];  //定时器低八位赋值 "fa"
 336   4                                                              TR0=1;                  //启动定时器T0  
 337   4                                                              for(j=0;j<=1000;j++)    //软件延时,在一定时间里检测     
 338   4                                                              {                                                                                       
 339   5                                                                      delay_ms(10);   //延时一下
 340   5                                                                      if(P3==0xfe) continue;  //"fa"按键按下,跳出(继续发音)
 341   5                                                                      else break;             //松开了,则返回
 342   5                                                              }
 343   4                                      //关闭屏幕显示
 344   4                                  LcdInit();//液晶初始化
 345   4                                                              Speak=1;        //蜂鸣器端口置1 (让蜂鸣器处于与电源5V断电状态)
 346   4                                                              TR0=0;          //关闭定时器T0
 347   4                                                              for(;;)
 348   4                                                              {
 349   5                                                                      while(P3==0xfe);        //等待按键松开
 350   5                                                                      delay_ms(10);           //延时去抖
 351   5                                                                      if(P3==0xfe) continue;
 352   5                                                                      else break;                     //确定松开,退出
 353   5                                                              }
 354   4                                                      }
 355   3                                                      TR0=0;          //关闭定时器T0  
 356   3                                                      break;          //返回
 357   3                              case 0xef:      //P3=0xf7       "so"按键按下 
 358   3                                                      delay_ms(10);   //延时去抖                      
 359   3                                                      if(P3==0xef)    //再判断"so"按键是否按下
 360   3                                                      {
 361   4                                  //屏幕显示"5"       
 362   4                                  LcdWriteCom(0x80+9);
 363   4                                  LcdWriteData(0X30+5);
 364   4                                                              i=4;                    //i置4                  
 365   4                                                              TR0=0;                  //关闭定时器T0          
C51 COMPILER V9.56.0.0   DZQ                                                               04/15/2020 10:04:46 PAGE 7   

 366   4                                                              sth=Music_Code[2*i];    //定时器高八位赋值 "so"
 367   4                                                              stl=Music_Code[2*i+1];  //定时器低八位赋值 "so"
 368   4                                                              TR0=1;                  //启动定时器T0          
 369   4                                                              for(j=0;j<=1000;j++)    //软件延时,在一定时间里检测     
 370   4                                                              {                                                                                                       
 371   5                                                                      delay_ms(10);           //延时一下
 372   5                                                                      if(P3==0xef) continue;  //"so"按键按下,跳出(继续发音)
 373   5                                                                      else break;                     //松开了,则返回
 374   5                                                              }
 375   4                                      //关闭屏幕显示
 376   4                                  LcdInit();//液晶初始化
 377   4                                                              Speak=1;        //蜂鸣器端口置1 (让蜂鸣器处于与电源5V断电状态)
 378   4                                                              TR0=0;          //关闭定时器T0
 379   4                                                              for(;;)
 380   4                                                              {
 381   5                                                                      while(P3==0xef);        //等待按键松开          
 382   5                                                                      delay_ms(10);           //延时去抖
 383   5                                                                      if(P3==0xef) continue;
 384   5                                                                      else break;                     //确定松开,退出
 385   5                                                              }
 386   4                                                      }
 387   3                                                      TR0=0;          //关闭定时器T0
 388   3                                                      break;          //返回
 389   3                              case 0xdf:      //P3=0xef       "la"按键按下
 390   3                                                      delay_ms(10);   //延时去抖
 391   3                                                      if(P3==0xdf)    //再判断"la"按键是否按下
 392   3                                                      {
 393   4                                  //屏幕显示"6"
 394   4                                  LcdWriteCom(0x80+9);
 395   4                                  LcdWriteData(0X30+6);
 396   4                                                              i=5;                    //i置5
 397   4                                                              TR0=0;                  //关闭定时器T0
 398   4                                                              sth=Music_Code[2*i];    //定时器高八位赋值 "la"
 399   4                                                              stl=Music_Code[2*i+1];  //定时器低八位赋值 "la"
 400   4                                                              TR0=1;                  //启动定时器T0          
 401   4                                                              for(j=0;j<=1000;j++)    //软件延时,在一定时间里检测     
 402   4                                                              {                                                                                       
 403   5                                                                      delay_ms(10);           //延时一下
 404   5                                                                      if(P3==0xdf) continue;  //"la"按键按下,跳出(继续发音)
 405   5                                                                      else break;                     //松开了,则返回
 406   5                                      }
 407   4                                      //关闭屏幕显示
 408   4                                      LcdInit();//液晶初始化
 409   4                                                              Speak=1;        //蜂鸣器端口置1 (让蜂鸣器处于与电源5V断电状态)
 410   4                                                              TR0=0;          //关闭定时器T0
 411   4                                                              for(;;)
 412   4                                                              {
 413   5                                                                      while(P3==0xdf);        //等待按键松开  
 414   5                                                                      delay_ms(10);           //延时去抖
 415   5                                                                      if(P3==0xdf) continue;
 416   5                                                                      else break;                     //确定松开,退出
 417   5                                                              }       
 418   4                                                      }
 419   3                                                      TR0=0;          //关闭定时器T0  
 420   3                                                      break;          //返回
 421   3                              case 0xbf:      //P3=0xdf       "si"按键按下
 422   3                                                      delay_ms(10);   //延时去抖
 423   3                                                      if(P3==0xbf)    //再判断"si"按键是否按下
 424   3                                                      {
 425   4                                  //屏幕显示"7"
 426   4                                  LcdWriteCom(0x80+9);
 427   4                                  LcdWriteData(0X30+7);
C51 COMPILER V9.56.0.0   DZQ                                                               04/15/2020 10:04:46 PAGE 8   

 428   4                                                              i=6;                    //i置6
 429   4                                                              TR0=0;                  //关闭定时器T0
 430   4                                                              sth=Music_Code[2*i];    //定时器高八位赋值 "si"
 431   4                                                              stl=Music_Code[2*i+1];  //定时器低八位赋值 "si"
 432   4                                                              TR0=1;                  //启动定时器T0  
 433   4                                                              for(j=0;j<=1000;j++)    //软件延时,在一定时间里检测     
 434   4                                                              {                                                                                       
 435   5                                                                      delay_ms(10);           //延时一下
 436   5                                                                      if(P3==0xbf) continue;  //"si"按键按下,跳出(继续发音)
 437   5                                                                      else break;                     //松开了,则返回
 438   5                                                              }
 439   4                                      //关闭屏幕显示
 440   4                                  LcdInit();//液晶初始化
 441   4                                                              Speak=1;        //蜂鸣器端口置1 (让蜂鸣器处于与电源5V断电状态)
 442   4                                                              TR0=0;          //关闭定时器T0
 443   4                                                              for(;;)
 444   4                                                              {
 445   5                                                                      while(P3==0xbf);        //等待按键松开
 446   5                                                                      delay_ms(10);           //延时去抖
 447   5                                                                      if(P3==0xbf) continue;
 448   5                                                                      else break;                     //确定松开,退出
 449   5                                                              }
 450   4                                                      }
 451   3                                                      TR0=0;          //关闭定时器T0
 452   3                                                      break;          //返回
 453   3                              case 0x7f:      //P3=0xbf       "高音do"按键按下
 454   3                                                      delay_ms(10);   //延时去抖      
 455   3                                                      if(P3==0x7f)    //再判断"高音do"按键是否按下
 456   3                                                      {
 457   4                               //屏幕显示"1"带小数点(1.)
 458   4                              LcdWriteCom(0x80+9);
 459   4                                  LcdWriteData(0x30+1);
 460   4                                  LcdWriteData(0x2e);   // 这个是小数点对应 的ascll 码
 461   4                                                              i=7;            //i置7          
 462   4                                                              TR0=0;          //关闭定时器T0
 463   4                                                              sth=Music_Code[2*i];    //定时器高八位赋值 "高音do"
 464   4                                                              stl=Music_Code[2*i+1];  //定时器低八位赋值 "高音do"
 465   4                                                              TR0=1;          //启动定时器T0                  
 466   4                                                              for(j=0;j<=1000;j++)    //软件延时,在一定时间里检测             
 467   4                                                              {                                                                                       
 468   5                                                                      delay_ms(10);           //延时一下
 469   5                                                                      if(P3==0x7f) continue;  //"高音do"按键按下,跳出(继续发音)
 470   5                                                                      else break;                     //松开了,则返回
 471   5                                                              }
 472   4                                      //关闭屏幕显示
 473   4                                  LcdInit();//液晶初始化
 474   4                                                              Speak=1;        //蜂鸣器端口置1 (让蜂鸣器处于与电源5V断电状态)
 475   4                                                              TR0=0;          //关闭定时器T0
 476   4                                                              for(;;)
 477   4                                                              {
 478   5                                                                      while(P3==0x7f);        //等待按键松开
 479   5                                                                      delay_ms(10);           //延时去抖
 480   5                                                                      if(P3==0x7f) continue;
 481   5                                                                      else break;                     //确定松开,退出
 482   5                                                              }
 483   4                                                      }
 484   3                                                      TR0=0;          //关闭定时器T0
 485   3                                                      break;          //返回
 486   3                              default:        break;          //没有P3没有按键按下,返回
 487   3                      }
 488   2                      
 489   2                      if(Key1==0)                     //按键1按下(播放 "挥着翅膀的女孩")
C51 COMPILER V9.56.0.0   DZQ                                                               04/15/2020 10:04:46 PAGE 9   

 490   2                      {
 491   3                              delay_ms(10);   //延时去抖
 492   3                              if(Key1==0)             //再判断按键1是否按下
 493   3                              {
 494   4                              //屏幕显示"A"
 495   4                          LcdWriteCom(0x80+0x40 +9);
 496   4                          LcdWriteData(0x30 + 1);
 497   4                                      for(i=0;Music_hzcb[i]!=0xff;i++)        //for循环语句                   
 498   4                                      {                               //Music_hzcb[]=0ff时,跳出for循环语句,停止播放音乐
 499   5                                              sth=yinfu1[(Music_hzcb[i]%100)/10-1][((Music_hzcb[i]%10)-1)*2];  //定时器高八位赋值
 500   5                                              stl=yinfu1[(Music_hzcb[i]%100)/10-1][((Music_hzcb[i]%10)-1)*2+1];//定时器低八位赋值
 501   5                                              i++;            //i加1
 502   5                                              TR0=1;          //启动定时器T0
 503   5                                              delay_ms(4*500/length[Music_hzcb[i]%10]);       //确定几分音符(节拍)            
 504   5                                              TR0=0;          //节拍结束,关闭定时器T0                          
 505   5                                      }
 506   4              //关闭屏幕显示
 507   4      LcdInit();//液晶初始化
 508   4      
 509   4                                      Speak=1;        //蜂鸣器端口置1 (让蜂鸣器处于与电源5V断电状态)
 510   4                                      for(;;)
 511   4                                      {
 512   5                                              while(Key1==0);         //等待按键松开  
 513   5                                              delay_ms(10);           //延时去抖
 514   5                                              if(Key1==0) continue;
 515   5                                              else break;                     //确定松开,退出 
 516   5                                      }
 517   4                              }
 518   3                      }
 519   2                      if(Key2==0)                     //按键2按下(播放 "同一首歌")    
 520   2                      {
 521   3                              delay_ms(10);   //延时去抖
 522   3                              if(Key2==0)             //再判断按键2是否按下
 523   3                              {
 524   4              //屏幕显示"B"
 525   4      LcdWriteCom(0x80+0x40 +9);
 526   4                          LcdWriteData(0x30 + 2);
 527   4                                      for(i=0;Music_tyshg[i]!=0xff;i++)       //for循环语句
 528   4                                      {                               //Music_tyshg[]=0ff时,跳出for循环语句,停止播放音乐
 529   5                                              sth=yinfu1[(Music_tyshg[i]%100)/10-1][((Music_tyshg[i]%10)-1)*2];  //定时器高八位赋值
 530   5                                              stl=yinfu1[(Music_tyshg[i]%100)/10-1][((Music_tyshg[i]%10)-1)*2+1];//定时器低八位赋值
 531   5                                              i++;            //i加1
 532   5                                              TR0=1;          //启动定时器T0
 533   5                                              delay_ms(4*500/length[Music_tyshg[i]%10]);      //确定几分音符(节拍)
 534   5                                              TR0=0;          //节拍结束,关闭定时器T0                                          
 535   5                                      }
 536   4      //关闭屏幕显示
 537   4      LcdInit();//液晶初始化
 538   4                                      Speak=1;        //蜂鸣器端口置1 (让蜂鸣器处于与电源5V断电状态)
 539   4                                      for(;;) 
 540   4                                      {
 541   5                                              while(Key2==0);         //等待按键松开  
 542   5                                              delay_ms(10);           //延时去抖
 543   5                                              if(Key2==0) continue;
 544   5                                              else break;                     //确定松开,退出
 545   5                                      }
 546   4                              }
 547   3                      }
 548   2                      if(Key3==0)                     //按键3按下(播放 "两只蝴蝶")
 549   2                      {               
 550   3                              delay_ms(10);   //延时去抖      
 551   3                              if(Key3==0)             //再判断按键3是否按下
C51 COMPILER V9.56.0.0   DZQ                                                               04/15/2020 10:04:46 PAGE 10  

 552   3                              {
 553   4              //屏幕显示"C"
 554   4      LcdWriteCom(0x80+0x40 +9);
 555   4                          LcdWriteData(0x30 + 3);
 556   4                                      for(i=0;Music_lzhhd[i]!=0xff;i++)       //for循环语句
 557   4                                      {                               //Music_lzhhd[]=0ff时,跳出for循环语句,停止播放音乐
 558   5                                              sth=yinfu1[(Music_lzhhd[i]%100)/10-1][((Music_lzhhd[i]%10)-1)*2];  //定时器高八位赋值
 559   5                                              stl=yinfu1[(Music_lzhhd[i]%100)/10-1][((Music_lzhhd[i]%10)-1)*2+1];//定时器低八位赋值
 560   5                                              i++;            //i加1  
 561   5                                              TR0=1;          //启动定时器T0
 562   5                                              delay_ms(4*500/length[Music_lzhhd[i]%10]);      //确定几分音符(节拍)
 563   5                                              TR0=0;          //节拍结束,关闭定时器T0                                  
 564   5                                      }
 565   4              //关闭屏幕显示
 566   4      LcdInit();//液晶初始化
 567   4                                      Speak=1;        //蜂鸣器端口置1 (让蜂鸣器处于与电源5V断电状态)
 568   4                                      for(;;)
 569   4                                      {
 570   5                                              while(Key3==0);         //等待按键松开
 571   5                                              delay_ms(10);           //延时去抖
 572   5                                              if(Key3==0) continue;
 573   5                                              else break;                     //确定松开,退出
 574   5                                      }
 575   4                              }
 576   3                      }
 577   2              }
 578   1      }
 579          
 580          /**********定时器T0中断服务函数**********/
 581          void time0() interrupt 1        
 582          {
 583   1              TR0=0;          //关闭定时器T0
 584   1              TH0=sth;        //定时器高八位赋初值
 585   1              TL0=stl;        //定时器低八位赋初值
 586   1              Speak=!Speak;   //蜂鸣器端口取反
 587   1              TR0=1;          //启动定时器T0
 588   1      }
 589          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1679    ----
   CONSTANT SIZE    =   1105    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     93    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
